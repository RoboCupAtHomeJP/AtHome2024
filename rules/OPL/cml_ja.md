<sub>[READMEへ](../../README.md)</sub>

[日本語](./cml_ja.md) | [English](./cml_en.md)

# Carry My Luggage（CML）

参考動画：https://youtu.be/dzyJ1dHTulc

> [!NOTE]  
> この動画は過去に実施された参考動画である．今年度とはルールが異なるため注意すること．

## メインゴール

オペレーターが外に駐車された車まで荷物を運搬することを，ロボットが支援する状況を想定して実施される．ロボットは荷物（バッグ）を掴んだ後，既知環境から未知環境までオペレータ追従し，荷物運搬の支援を行う．その後，ロボットは自律的にスタート地点（既知環境）まで戻る．

> [!NOTE]  
> 本タスクのシナリオはEducationリーグと共通である．ただし，ルールや採点方法はの一部は異なる．

## フォーカス

このタスクは，指差し認識，マニピュレーション，既知環境と未知環境でのマッピングやナビゲーション，人追従走行，音声対話，タスクプランニングなどに焦点を当てている．


## セットアップ

- **ロケーション**：家庭環境を模したアリーナ環境が用いられる．競技はアリーナの内外で行われる．`アリーナ内`は事前にマッピングすることができる（`既知環境`）．`アリーナ外`は事前にマッピングすることが禁止されている（`未知環境`）．
- **スタート地点**： スタート地点はsetup dayに公開される．
- **荷物（バッグ）**： オペレーターの近く（2\[m\]以内の距離でロボットから見える位置）に，2つのバッグを設置する．
  - **サイズ**：350×25×350\[mm\] 以内の大きさのバッグが用いられる．
  - **配置場所**：配置場所の候補地点はsetup dayに公開される．タスク開始直前に，レフェリーから指定された場所へ各チームでバッグを配置する．
- **オペレーター**： オペレーターは，ロボットの前に立って競技で使用するバッグを指さす．オペレータはボランティアより選出される．

## シナリオ

### スタートフェーズ

1. **競技時間**：競技時間は**7分間**である．
1. **配置**：レフェリーは，チームにロボットをスタート位置へ移動させるよう指示する．
1. **スタート**：レフェリーはスタートの合図を出し，タイマーをスタートさせる．同時にチームは最後の簡単なセットアップ（スタートボタンを押す等）を完了し，エリアを離れる．このとき，ボタンを2つ以上押すなど複雑なセットアップ手順の実施は認められない．
1. **指差し**：オペレータはスタートの合図と同時に，2つのバッグの内，事前に指定されたバッグの方を指さす．
1. **把持**：ロボットは，オペレータが指さしたバッグを認識し，それを把持する．

### フォロミーフェーズ

1. **運搬開始**：ロボットがバッグを把持し追従可能な状態になったら，ロボットはオペレーターにその主旨を伝える．
2. **歩行**：その後，オペレータは既知環境から未知環境に向かって歩き始める．
3. **フォロミー**：ロボットは歩き始めたオペレータを追従し，走行する．オペレータがゴールにたどり着いた場合，オペレータからその旨を伝えてもらう．

> **Warning**
> (Natural walking) オペレータは歩行を開始した後，ロボットの方を振り返ること，歩行を止めることはできない．

### ナビゲーションフェーズ

1. **受け渡し**：オペレータとロボットがゴールに着いた後，オペレーターはロボットからバッグを受け取る．
2. **ナビゲーション**：ロボットは未知環境から既知環境にある`スタート地点`まで障害物を避けながら自律的に移動する．使用する障害物はチームが選択することができる（最大4つ，ボーナス）．ボーナス点はロボットがスタート地点へ戻ることができた場合，回避した障害物の数により加算される．
この障害物の種類には下記の4つのモノがある．
   - 人混み（3～4人）が静的な状態で邪魔をする
   - 地面にある小さな物体（積み木など）
   - 見づらい3Dオブジェクト（椅子やグラスなど）
   - 開閉式バリア（ガイドポールなど）
1. **ゴール**：ロボットが`スタート地点`へ戻ったら，タスク終了になる．

## デウス・エクス・マキナ

本タスクでは，次のデウス・エクス・マキナが採用される．デウス・エクス・マキナでは該当アクションの点数は入らないが，より簡単な手法で部分的なタスクをスキップし，全体的なタスクを継続することができる．

|Action|Bypassing|
|------|---------|
| バッグの選択 | 設置されている2つのバッグの中で1つに限定する（1つのバッグのみが設置される） |
| バッグの把持 | ロボットが選択したバッグを，オペレータがロボットに持たせる．その際，ロボットがオペレーターにバッグの位置を伝える |
| マーカを用いた人追従走行 | マーカをオペレータに持たせた状態または取り付けた状態で人追従走行を行う |

## スコアシート

|Action|Score|
|------|-----|
| **メインタスク** |  |
| バッグをアリーナの外にあるゴールまで持ち運ぶ | |
| &nbsp;&bull;&nbsp;オペレータが選択したバッグの検出 | 50 |
| &nbsp;&bull;&nbsp;選択されたバッグの把持 | 100 |
| &nbsp;&bull;&nbsp;オペレーターを追従してアリーナの外に出る | 50 |
| &nbsp;&bull;&nbsp;オペレーターを追従してアリーナの外にあるゴールへ着く | 50 |
| アリーナへの再入場 |  |
| &nbsp;&bull;&nbsp;自律的にアリーナ内に入る | 25 |
| &nbsp;&bull;&nbsp;自律的に`スタート地点`へ戻る | 25 |
| **ボーナスタスク** |  |
| 静的な人混み（3～4人）を回避する | 50 |
| 地面にある小さな物体（積み木など）を回避する | 50 |
| 見づらい3Dオブジェクト（椅子やグラスなど）を回避する | 50 |
| 開閉式バリア（ガイドポールなど）を回避する | 50 |
| **ペナルティ** |  |
| 不参加（無断） | -500 |
|  |  |
| 合計（ボーナスタスクを含む） | 500 |

## TCによる指示

- 準備
  - オペレータ役を割り当てる．
  - バッグが置かれる位置の候補を公開する．
  - 外の道でロボットの行く手を阻む人を3～4人選ぶ．
  - ロボットが屋外で直面する障害物を選択する．
- アナウンス（Setup day）
  - ロボットの`スタート地点`の選択し，アナウンスする．
  - 使用するバッグをアナウンスする．
  - 使用する障害物を公開する．
- アナウンス（競技開始直前）
  - ゴール（車）の位置を選択する．
  - バッグを置く位置を指定する．

## 採点係の動き

- 競技開始30分前に集まり，説明を受け，スコアシートを受け取る．
- スコアシートに基づき，競技を採点する．
- 他の採点係と採点内容を確認し合う．
- スコアシートを提出する．

> [!NOTE]  
> 採点係は各チームから数名選出され，他チームの競技において以下を行ってもらう．詳細については，一般規定の[採点方法](./gr_ja.md#採点方法scoring-system)を確認すること．
