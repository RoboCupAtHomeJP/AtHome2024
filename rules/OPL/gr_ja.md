<sub>[READMEへ](../../README.md)</sub>

[日本語](./gr_ja.md) | [English](./gr_en.md)

# 一般規定（General Rules & Regulations）

RoboCup Japan Open @Home 2023（`RCJ2023`）のOpen Platform League（`OPL`）における競技は，このページに記載した一般規定に従って開催される．
この一般規定については，[RoboCup 2022 Rulebook (Rev-1298)](https://athome.robocup.org/wp-content/uploads/2022_rulebook.pdf) のChapter 3 `General Rules & Regulations` をもとに作成している．
[RoboCup 2022 Rulebook (Rev-1298)](https://athome.robocup.org/wp-content/uploads/2022_rulebook.pdf)からの変更で，このページに記載していない事項については，考慮しないものとする．そのため，GitHubのIssuesより，参加チームとの議論の上，ルールを確定していく．


## チーム登録と参加資格（Team Registration and Qualification）

チーム登録（Team Registration）は日本ロボカップ委員会を通して行われる．`RCJ2023`では，チーム登録に2つの段階がありる．

1. 事前登録
1. ~~チーム選考~~
1. 最終登録

事前登録や最終登録についての情報は，RoboCup@Home JPのメーリングリストやSlack上で発表される予定です．この際，チーム選考（Qualification）は行わない．参加登録を済んだ全チームが参加できる．

### 事前登録（Pre-registration）

`RCJ2023`における事前登録は下記のリンクから記入する．チーム登録締め切りは`3月31日（金）午後1時`となっている．多数のご登録お待ちしております．

> [!NOTE]  
> 事前登録フォーム：https://forms.gle/wzCGnJwkGiw2KUfg8

なお，実施されるリーグは以下のようになる．また，事前登録フォームへの記入の際は，複数のリーグへの参加をご検討されるチームはそれぞれのリーグに対して，リーグごとの参加登録を記入してください．

- Open Platform League（OPL）
- Domestic Standard Platform League（DSPL）
- Education League
- Simulation Open Platform League（S-OPL）

> [!NOTE]  
> すべてのリーグは現地参加のみとなるので，ご注意ください．

### 最終登録（Final Registration）

`RCJ2023`における最終登録は，以下のウェブサイトにある「参加登録」（Google Form）を利用して行う．
詳細は公式ウェブサイトの「[申し込み方法](https://www.robocup.or.jp/japanopen2023/registration.html)」の説明をご覧ください．
この際，チームコードは，仮登録時に発行されたものをご利用ください．

> [!NOTE]  
> 最終登録 - 参加登録フォーム：https://docs.google.com/forms/d/e/1FAIpQLSeYN8dRqkmi4Q_4idUBG4yEoLghzEcGQVQHaSru67Fn1A4CtQ/viewform


## 運営（Organization）

### 実行委員会（Executive Committee - EC）

実行委員会（EC）は，リーグ戦のルールに関する責任者であり，大会の進行を行う．実行委員会（EC）は，前大会の優勝チームから1名，準優勝チームから1名選出される．主な役割は，大会進行やルールブックの作成とレフェリングです．RoboCup Japan Open @HomeではECのメンバーが，必ずTCのメンバーの役割も果たす．

### 技術委員会（Technical Committee - TC）

技術委員会（TC）は，大会の進行をサポートする．技術委員会（TC）は各チームから任意で選出される．主な役割は，各競技のレフェリーや採点作業です．

### 組織委員会（Organizing Committee - OC）

組織委員会（OC）は，大会を運営する．主な役割は，スケジュールやルールを作成し，各競技のシナリオに関する情報をアナウンスすることです．
一方で，現地組織委員会（LOC）は，競技会場の設営・運営を担当する．


## 観客との交流（Audience interaction）

RoboCup@Homeの魅力の1つは，ロボットが何をすべきか，タスクの中で実際に何を行っているかを観客に見せることでもある．特に，ロボットが何をしているかという情報を観客に伝えることは，リーグの発展にとっても重要となる．そのため，YouTubeなどの動画配信サービスを用いて，競技の様子を配信することがある．また，運営として観客がロボットの動作に邪魔しないように，できる限り注意を払う．ただし，アリーナ内で実施されているタスクが範囲外の観客の動きによって，認識ができなくなる（例：骨格検出の不具合等）恐れがあるため，その対処方法を各チームに考慮しておく必要がある．


## シナリオ（Scenario）

ほとんどの競技タスクは，RoboCup@Homeのアリーナ内で行われるが，一部のテストは事前に知らされていない公共の場所のような屋外で行われることもある．ここでは，アリーナとその内容，特にテストとリーグで共通する道具や家具等について説明する．

### アリーナ（Arena）

`RCJ2023`におけるアリーナ情報については，`WRS2020`に基づいて環境設定を行う．
<!-- RoboCup@Homeでは，それぞれの場所には，場所クラスが設定されている． -->

ただし，ロボットは現実の世界で機能する必要があるため，アリーナは固定されておらず，予告なく変更される場合がある．

1. **メジャーチェンジ**：日常的な環境では完全に固定されない家具は，競技の間に少し移動されることがある．家具の配置を変えたり，部屋の中を大きく移動したりすることはないが，ソファやテーブルが少し回転したり移動したりする可能性がある．`RCJ2023`では，そのような家具の位置を固定しない．また，壁は固定され，部屋の構造は変わらないが，通路は塞がれる可能性がある．

1. **マイナーチェンジ**：椅子が多少動いたり，ドアが完全に閉まっていなかったりすることは競技中であっても常に起こることがある．

### 物体（Objects）

RoboCup@Homeでは，物体の認識と操作を伴うタスクがある．このようなタスクでRCAP2021に基づいて使用する9個の物体のリストを用意している．物体リストは下記のリンクから確認できる．リストには，各物体の写真，正式名称，物体カテゴリ（例えば，`Noodle`は`Food`のカテゴリに属す）が記載される．ほとんどのオブジェクトは軽量で，ロボットが簡単に掴める物になっている．各物体のカテゴリーごとに，設置されている場所や，片づけるべき場所が決まっている．このカテゴリを参照することで，競技中にそのカテゴリの物体を見つけたり，片づけたりしていく．物体を加工することは禁止とするので，ご注意ください．

また，競技タスクでは，物体を「`既知物体`（事前公開＋直前公開）」と「`未知物体`」として分けて使用していく．このとき，`既知物体`とは，競技のルールの公開とともに事前公開している物体と，競技の`Setup Day`に公開する直前公開の物体という2つの種類に分ける．競技本番は，各チームが持ち寄せた物体を使用する．また，`未知物体`とは，物体リストにない物体で，把持・操作可能なものを指している．競技タスクによっては，この未知物体を使用することがある．

> [!NOTE]  
> 事前公開物体リスト（RCAP2021で使用した物体）：https://github.com/RoboCupAtHomeJP/AtHome2021/blob/master/Data/opl_known_object_list.pdf

### 事前に定義された人の名前（Predefined Person Names）

RoboCup@Homeでは，人の名前を使用したタスクがある．アリーナにいるすべての人には，事前に定義された名前が割り当てられている．

### 無線ネットワーク（Wireless network）

`RCJ2023`では，無線通信のネットワーク環境が提供されないので、ご注意ください．

<!--

そのため，会場での運営から提供された（もしくは独自の）WiFiアクセスポイントの使用を許可とする．
> **Warning**
> WiFiの使用許可についてはRCJ2023のECと確認中です。決定次第、報告する。

> **Warning**
> ロボットの不自然な動き（遠隔操作等による動作）を発覚した場合，減点，失格，あるいは大会全体の失格といったペナルティが課されることがある．

-->

## ロボット（Robots）

`RCJ2023`で使用するロボットは，下記の項目を満たしている必要がある．
これらを満たしているかどうかの確認は，[Robot Inspection](./ri_ja.md)で行う．

### ロボット台数（Number of Robots）

1. **ロボットの登録台数**：1チームあたりのロボット台数は最大2台までとなっている．ただし，[Robot Inspection](./ri_ja.md)をクリアしたロボットのみを競技で使用することが可能です．

1. **競技タスク時の台数**：1回の競技テストで使用できるロボットは1台のみです．異なる競技テストでは，異なるロボットを使用することが可能です．

1. **Technical Challengeでの台数**：Technical Challengeでは，登録した最大2台のロボットを同時に使用することが可能です．

### ロボットの仕様（Robot Specification）
RoboCup@Home Open Platform Leagueに参加するロボットは，動作中に危害を加えないよう，下記の仕様に準拠する必要がある．

#### **サイズと重量（Size and Weight）**

1. **寸法**：ロボットの寸法は，環境に使用されるドアの幅（1.2\[m\]）に入れるような幅のサイズを超えないようにしなければならない．運営の方で，より大きなロボットの参加資格と登録を認めることがあるが，そのロボットが実際にアリーナに入れることを保証するものではない．確認が必要な場合は，運営にお問い合わせください．

1. **重量**：ロボットの重量と床にかかる圧力は，大会が開催される国のオフィスや居住用の建物の建築に関する規制を超えないようにする必要がある．

1. **運搬**：チームは，ロボットをアリーナから素早く移動させられるようにする必要がある．もし，ロボットが自律的に移動できない場合，いかなる理由であれ，チームはロボットを迅速かつ容易に移動させられなくてはならない．

#### **外観と安全性（Appearance and Safety）**

1. **カバー**：ロボット内部のハードウェア（電子機器やケーブル）は，カバーで覆い，安全性を確保してください．

1. **ケーブル**：ロボットから垂れ下がるようなケーブルは禁止としている．必ず，ロボットの内部で収まるようにしてください．

1. **安全性**：ロボットに鋭利な刃物や人に危害を加えるような要素を入れてはいけない．

1. **迷惑行為**：大きな音を出し続けたり，眩しい光で照らしたりしてはいけない．

1. **ナビゲーション**：ロボットによる安全な自律走行を行うため，障害物を回避できるナビゲーション技術が必須となる．

<!-- 「マーク：人工的なマークやパターンをつけてはいけない．」についてはどうするべきか？ -->
<!-- ロゴとかをつけているチームやハンドにQRマーカをつけているチームがある． -->

#### **非常停止ボタン（Emergency Stop Button）**

1. **アクセス性と視認性**：全てのロボットは，非常停止ボタンを，目に見える位置かつ簡単に押せる位置に設置する必要がある．

1. **色**：緊急停止ボタンは赤色であり，ロボット上で唯一の赤色ボタンでなければいけない．もし，他に赤色のボタンがあった場合は，運営がロボット上にある他の赤色ボタンをテープで覆うか，取り除くようチームに要求することがある．

1. **ロボットの動作**：非常停止ボタンが押された場合，ロボットとその部品は直ちに動きを停止しなければならない．

<!-- スタートボタンについては要検討 -->

<!-- 外部機器については要検討 -->
<!-- ## 5 外部機器
チームが競技中に使用するロボットの一部でないものは全て「外部機器」とみなされる．全ての外部機器は，[Robot Inspection](https://github.com/RoboCupAtHomeJP/Rule2023/blob/rules/opl/robot_inspection.md)において，運営の認可を受けなければいけない．この際，運営は外部機器を自由に使用できるか，審判の監視下で使用できるかを指定し，採点に与える影響を判断する．なお，イヤホンやヘッドホンなどの無線機器の使用は，外部機器としても使用が認められない．また，大会主催者は，アリーナ内のネットワークやインターネット接続の可用性や信頼性に関して，いかなる保証や責任も負わないことに注意してください．チームは自己の責任において外部機器を使用することができる．
-->


## 競技構成（Organization of the Competition）

`RCJ2023`の競技は，[AtHome2023](https://github.com/RoboCupAtHomeJP/AtHome2023)で公開されたタスクを数日間に分けて行っていく．

### 採点方法（Scoring System）

`RCJ2023`では，ロボットによる`競技タスク`と`Technical Challenge`という研究発表の2つの競技がある．採点は，2つの競技ごとに別々で行われ，別々に表彰される．どちらとも参加していただいても，片方だけ参加して頂いても構わない．参加競技を事前に運営の方にその旨を伝えてください．

#### **競技タスク**

`RCJ2023`では，全チームが全競技タスクへの挑戦権を有している．こちらは，別途アナウンスしたルール，配点，及びスケジュールに従って実施される．ここでは，`Technical Challenge`を除く各競技タスクにおける最高得点の合計点で競い合う．このとき，`Robot Inspection`を除く各競技タスクの最高得点は500点となっている．採点方式は下記のようになっている．

自チームメンバー1名と他チームメンバー1名の2名による採点を行う．その順番は時計回りで決まり，次の例のようで採点を行う．

- タスク1回目
  - `チームA`の採点：`チームA`から1名，`チームB`から1名（計2名で実施）
  - `チームB`の採点：`チームB`から1名，`チームC`から1名（計2名で実施）
  - `チームC`の採点：`チームC`から1名，`チームA`から1名（計2名で実施）
- タスク2回目
  - `チームA`の採点：`チームA`から1名，`チームC`から1名（計2名で実施）
  - `チームB`の採点：`チームB`から1名，`チームA`から1名（計2名で実施）
  - `チームC`の採点：`チームC`から1名，`チームB`から1名（計2名で実施）
- タスク3回目以降は以上と同様に続く

> [!NOTE]  
> `RCJ2023`のOPLでは，Educationリーグとの繋がりを強くする方針で動いてう．教育を目的としたEducationリーグにて培った技術力を，ぜひOPLで発揮していってもらいたいです．そのため，OPLでは，Educationリーグで行われている`Carry My Luggage`という競技を採用し，この競技ルールはEducationリーグと同じです．

#### **Technical Challenge**

`RCJ2023`では，全チームが`Technical Challenge`への挑戦権を有している．こちらは，別途アナウンスしたルール，配点，及びスケジュールに従って実施される．独自の技術をアピールする機会となっており，そのプレゼンテーションやデモンストレーションを通して，審査員によって採点される．

### スケジュール（Schedule）

詳細な実施される競技のスケジュールについては，[AtHome2023](https://github.com/RoboCupAtHomeJP/AtHome2023)にて公開する．


## 競技時の注意（Procedure during Tests）

`RCJ2023`の競技は，下記の項目に気を付けて，決まった手順通りに競技を実施していく．

### 安全第一（Safety First!）

1. **緊急停止**：競技の内外でロボットを操作する際，人や物に対して危険な動作をする可能性がある場合，チームはいつでもロボットを直ちに停止させなければいけない．

1. **要請での停止**：審判員，技術委員会，組織委員会，連盟役員，評議員からロボットの停止を指示された場合，議論の余地はなく，直ちにロボットを停止させなければいけない．

1. **ペナルティ**：チームがこれらに従わない場合，チームとそのメンバーはRoboCup@Homeの運営の決定次第，進行中の競技から即座に除外される．さらに，そのチームとメンバーは，RoboCup連盟評議員会の決定により，1年以上の期間，今後の大会への出場を禁じられる場合がある．

### チームメンバーの最大人数について（Maximum number of team members）

1. **競技時**：競技中，アリーナ内に入れるチームメンバーの最大人数は1名です．ただし，ボランティアの協力が必要な場合は例外とする．

1. **セットアップ**：競技のセットアップ中は，アリーナ内のチームメンバーの人数に制限はない．

1. **Technical Challenge**：`Technical Challenge`では，アリーナ内に入れる人数に制限はない．

### フェアプレイ（Fair Play）

大会期間中，全てのチームにフェアプレーと協力的な行動が求められている．特に，下記の時は注意してください．
- 他チームを評価するとき
- 審判をしているとき
- 他チームのロボットと交流するとき

ここでいうフェアプレイとは，下記のことを指している．
- 不正をしようとしない（例：何もないところで自律的な行動を装う）
- ルールを悪用しない（例：課題を解決しようとせず，得点を狙う）
- 他のロボットをわざと失敗させようとしないこと
- 標準的なプラットフォームのロボットを改造しないこと

> **Warning**
> このルールを無視した場合，減点，失格，あるいは大会全体の失格といったペナルティが課されることがある．

### 期待されるロボットの行動（Expected Robot’s Behavior）

特に断らない限り，ロボットは礼儀正しく親切な人間がするのと同じように振る舞い，反応することが期待されている．これは，ロボットが与えられた課題をどのように解決する際にも当てはまる．ロボットの専門家でない一般的なユーザに伝わるような行動や振る舞いを心がけましょう．このとき，一般的なユーザは，ロボットを操作する具体的な手順を知らないことを考慮してください．具体的には，ロボットが行う動作を発言されることが重要となる．

### ロボットの自律性と遠隔操作（Robot Autonomy and Remote Control）

1. **接触禁止**：競技中，参加者は，タスクで必要とされる場合を除き，ロボットと接触することはできない．

1. **自然なインタラクション**：ロボットとのインタラクションは，ジェスチャーと会話のみとしている．

1. **操作禁止**：直接操作に類するものは禁止とする．

1. **遠隔操作**：ロボットを遠隔操作することを禁止とする．また，ボタンを押したり，故意にセンサーに影響を与えるようなことも禁止している．

> **Warning**
> このルールを無視した場合，減点，失格，あるいは大会全体の失格といったペナルティが課されることがある．

### 接触や衝突（Collisions）

1. **接触**：操作対象以外の物体に少しだけ触れてしまうことはある程度許容されるが，推奨はされない．ただ，ロボットが何かに衝突することは許されない．このとき，「[安全第一](#安全第一safety-first)」のルールが，他のいかなるルールよりも優先される．

1. **衝突**：競技中に，ロボットが何かに衝突した場合，そのロボットは直ちに停止される．衝突によって，追加のペナルティが適用される場合もある．

1. **機能的な接触**：ロボットが物体を掴むために圧力をかけたり，競技によっては家具を押し退けたり，マニピュレータ以外の構造部分を用いて環境と相互作用することは認められている．しかし，ロボットは衝突でないインタラクションであることを明確に告げる必要がある．

1. **ロボット同士の回避**：2台のロボットが遭遇するような競技の場合，両者は積極的に相手のロボットを避けようとしなければならない．合理的な時間（例えば30秒）以内に，別のルートを目指さないロボットは排除される可能性がある．

> **Warning**
> 審判が危険な動作が疑われる場合，即座にロボットを停止させることがある．

### ロボットの撤去（Removal of robots）

上記のルールに従わないロボットは停止し，アリーナから撤去される．

1. ロボットを撤去するかどうか，またいつ撤去するかは，審判員および競技を監視している技術委員（TC）メンバーの判断によって決められる．

1. 審判員や技術委員（TC）メンバーから指示があった場合，チームは直ちにロボットを停止し，進行中の競技の妨げにならないようにアリーナから撤去しなければならない．

### スタート指示（Start signal）

デフォルトのスタート指示は，特に断りのない限り，`ドアオープン`（扉を開くとき）となる．他のスタート指示を使用することも可能ですが，ロボット検査において技術委員（TC）が許可したものでなければならない．

### アリーナへの入場と退場（Entering and leaving the Arena）

1. **スタート位置**：特に明記されていない限り，ロボットはアリーナの外からスタート位置とする．

1. **入場**：ロボットは，`ドアオープン`後に，自律的にアリーナに入場しなければならない．

> [!NOTE]  
> ロボットが`ドアオープン`によって入場した後，使用した扉を閉めることができる．このとき，ロボットが通路を塞いでいない場合，入場したとみなされる．

### オペレータ（Operators）

`RCJ2023`では，基本的にロボットのオペレータを，自チームから出して良いものとしている．ただし，オペレータ以外に登場する人については，運営で選出した者によって競技が行われることもある．

### 時間制限（Time limits）

`RCJ2023`では，各競技タスクで設定された制限時間にて運用していく．競技の達成時間による加点なども特にない．

### リスタート（Restart）

`RCJ2023`では，制限時間内であれば，何回でもリスタートを行うことを可能としている．ただし，リスタート直後に獲得した点数が半分となる．その後のタスクの点数は変わらない．

また，リスタート時に，ロボットが物体を持っている場合は，物体を持たせたままにするか，取り上げるかは自チームの判断により選択できる．ただし，取り上げた物体は，その後アリーナの外で保管する．そのため，取り上げた物体に関しては，その競技が終了するまで改めて使用することを不可とする．

### 音声対話での聞き返（Verification in Voice Recognition）


`RCJ2023`では，全競技タスク共通して，音声対話での聞き返す回数による減点を行わない．ただし，競技時間による制限はあるので，「[デウス・エクス・マキナ](#デウス・エクス・マキナdeus-ex-machina)」等を駆使して，なるべくロボットを動作させ，得点の獲得を推奨する．

### 物体の配置（Placement of the objects）

`RCJ2023`では，競技で使用する物体を自チームで設置して良いものとしている．ただし，運営側から指定された設置する物体の順番や使用する物体通り競技が行われる．


## デウス・エクス・マキナ（Deus ex Machina）

ロボットは，タスクの主目的を達成しない限り，点数を得ることができない．しかし，多少の不具合によってロボットがタスクを達成できなくなるといったことがよく起こってしまう．このような事態を防ぐために，ロボットは競技中，人に助けを求めることができるようになっている．

音声認識が入らずにタスクがスタートしない，物体が掴めずにタスクが続行しないなど，チーム，観客の双方にとって望ましくない状況を起こさないために，それらの部分的なタスクを回避する手段を積極的に活用することを推奨する．

### 手順（Usage）

タスクの解決中に人の支援を要請する手順は下記の通りになる．

1. **支援のお願い**：ロボットは，人の助けが必要であることをはっきりと示さなければいけない．特に，下記の項目には気を付けてください．
    - 支援の内容
    - 特定の目標または望ましい結果
    - どのような動作をしなければならないか（必要な場合）
    - ロボットとの対話方法の詳細（必要な場合）

1. **支援後の対応**：ロボットに指示された行動を行った後，人は要求された行動が完了したことをロボットに伝えなければいけない．

1. **感謝**：ロボットは支援してくれた人に対して，丁寧にお礼を言わなければならない．

### 例（Example）

`デウス・エクス・マキナ`は，各競技タスクごとに，様々なものが用意されている．詳細については，それらの競技内容を確認してください．また，追加してほしい`デウス・エクス・マキナ`があれば，GitHubのIssueにて教えてください．運営の方で検討後，積極的に採用していきたいと考える．

<!--
`RCJ2023`では，特に下記のようなデウス・エクス・マキナを強く推奨している．

- QRコードの積極活用による音声認識代替手段の確実な確保
- ロボットに搭載されたタッチディスプレイなどによるインタラクション方法の活用
- ロボットの音声やディスプレイ表示を用いたレフェリーへの指示
-->

「ドアを開けてください」，「椅子をどかしてください」，「モノを取ってハンドの中に入れてください」など，ロボットが分かりやすく指示したことについては，レフェリーは最大限対応する．ただし，音声が小さく聞き取れない，母国語では無い英語または日本語の指示が聞き取れない，画像が小さくて読めないなど，レフェリーの限界を超える点については対応できない．

> **Warning**
> ロボットへ直接コマンドを送信することなどは，`デウス・エクス・マキナ`においても禁止されている．あくまで，ロボットとのインタラクションを簡易化するものになっている．

### スコア（Scoring System）

ロボットが，人に支援を要求するような`デウス・エクス・マキナ`を使用できる回数に制限はない．しかし，`デウス・エクス・マキナ`を使用した際のタスクの得点は，減点または失点することがある．詳細については，各競技タスクのルールを確認してください．


## 不参加時のペナルティ（Penalty for not attending）

競技中のペナルティ以外にも，無断で欠席した場合においてもペナルティが課せられる．
競技開始までの流れについては，下記の項目を確認してください．

1. **スケジュールの公開**：全チームが全ての競技タスクに参加することになる．ただし，参加登録時に参加しない競技を運営に伝えた場合は，スケジュールから除かれる．

1. **アナウンス**：各競技開始前に運営によるアナウンスがある．もし，チームが参加できなくなった場合（理由の如何を問わず），チームリーダーはアナウンス開始の60分前までに運営にその旨を伝えなければならない．

1. **ペナルティ**：予定された競技タスクが始まるときに，スタート位置にいないチームは，そのテストに参加することができない．チームが参加できないことを運営に伝えていない場合，各競技共通して500点のペナルティが課される．
